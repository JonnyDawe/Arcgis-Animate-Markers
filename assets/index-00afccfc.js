var S=Object.defineProperty;var C=(n,e,t)=>e in n?S(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var s=(n,e,t)=>(C(n,typeof e!="symbol"?e+"":e,t),t);import{h as y,a as u,R as b,c as H,d as I,y as P,L as G,x,_ as T,H as L,E,p as v,m as F}from"./vendor-52594844.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(a){if(a.ep)return;a.ep=!0;const i=t(a);fetch(a.href,i)}})();const _="/Arcgis-Animate-Markers/assets/bugle-f4909af2.wav",O="/Arcgis-Animate-Markers/assets/cat-427afe9d.wav",z="/Arcgis-Animate-Markers/assets/drums-a00e44f7.mp3",R="/Arcgis-Animate-Markers/assets/guitar-559adb71.wav",N="/Arcgis-Animate-Markers/assets/trumpet-c3f50bf2.wav";function A(n,e){let t,r,a;const i=async()=>{r&&(a=n(...r),r=void 0),t=void 0};return async(...o)=>(r=o,t||(a=n(...o),t=window.setTimeout(i,e)),a)}class D{constructor({symbolAnimationManager:e,mapView:t,layerView:r,to:a,easingConfig:i}){s(this,"mapView");s(this,"layerView");s(this,"to");s(this,"easingConfig");s(this,"symbolAnimationManager");s(this,"clickHandler");s(this,"hoverHandler");s(this,"sounds",{meowSound:new y.Howl({src:O}),trumpetSound:new y.Howl({src:N}),hornSound:new y.Howl({src:_}),guitarSound:new y.Howl({src:R}),drumSounds:new y.Howl({src:z,sprite:{kick:[0,350],hihat:[374,160],snare:[666,290],cowbell:[968,200]}})});s(this,"hoverHitTest",A(async(e,t)=>{const{results:r}=await this.mapView.hitTest(e,t);r.filter(i=>i.type="graphic").length?this.mapView.container.style.cursor="pointer":this.mapView.container.style.cursor="default"},70));s(this,"clickHitTest",async(e,t)=>{const{results:r}=await this.mapView.hitTest(e,t),a=r.filter(i=>i.type="graphic");if(a.length){const i=a[0].graphic;i.symbol=await b(i);const o=this.symbolAnimationManager.makeAnimatableSymbol({graphic:i,easingConfig:this.easingConfig});this.animatePointPopEffect(o)}});this.mapView=t,this.layerView=r,this.to=a,this.easingConfig=i,this.symbolAnimationManager=e,this.clickHandler=u(()=>this.mapView,"click",o=>{const c={include:[this.layerView.layer]};this.clickHitTest(o,c)}),this.hoverHandler=u(()=>this.mapView,"pointer-move",o=>{const c={include:[this.layerView.layer]};this.hoverHitTest(o,c)})}animatePointPopEffect(e){e.symbolAnimation.start({to:this.to,onStart:()=>{const t=()=>this.cancelAnimation(e);switch(e.attributes.soundType){case"cat":{this.playSound(this.sounds.meowSound,t);break}case"trumpet":{this.playSound(this.sounds.trumpetSound,t);break}case"horn":{this.playSound(this.sounds.hornSound,t);break}case"guitar":{this.playSound(this.sounds.guitarSound,t);break}case"drum":{Math.random()>.5?this.playSound(this.sounds.drumSounds,t,"snare"):this.playSound(this.sounds.drumSounds,t,"hihat");break}default:t()}}})}cancelAnimation(e){e.symbolAnimation.start({to:{scale:1,rotate:0},onFinish:()=>{this.symbolAnimationManager.removeAnimatedGraphic({graphic:e})}})}playSound(e,t,r){e.off();const a=e.play(r);e.on("end",()=>{e.playing(a)===!1&&t()},a)}destroy(){this.clickHandler.remove(),this.hoverHandler.remove()}}const X="/Arcgis-Animate-Markers/assets/expressionless-face_1f611-18c3e2ac.png",Y="/Arcgis-Animate-Markers/assets/partying-face_1f973-fd5f4c50.png";class M{constructor({symbolAnimationManager:e,mapView:t,layerView:r,easingConfig:a={type:"easing",options:{easingFunction:"linear",duration:3e3}}}){s(this,"mapView");s(this,"layerView");s(this,"easingConfig");s(this,"symbolAnimationManager");s(this,"clickHandler");s(this,"hoverHandler");s(this,"confetti");s(this,"hoverHitTest",A(async(e,t)=>{const{results:r}=await this.mapView.hitTest(e,t);r.filter(i=>i.type="graphic").length?this.mapView.container.style.cursor="pointer":this.mapView.container.style.cursor="default"},70));s(this,"clickHitTest",async(e,t)=>{const{results:r}=await this.mapView.hitTest(e,t),a=r.filter(i=>i.type="graphic");if(a.length){const i=a[0].graphic;i.symbol=await b(i);const o=this.symbolAnimationManager.makeAnimatableSymbol({graphic:i,easingConfig:this.easingConfig});this.animatePointPopEffect(o)}});s(this,"onAnimationStep",(e,t,r)=>g(e));this.mapView=t,this.layerView=r,this.easingConfig=a,this.symbolAnimationManager=e;const i=document.createElement("canvas");i.classList.add("confetti-canvas"),t.ui.add(i,"manual"),this.confetti=H.create(i,{resize:!0,useWorker:!0}),this.clickHandler=u(()=>this.mapView,"click",o=>{const c={include:[this.layerView.layer]};this.clickHitTest(o,c)}),this.hoverHandler=u(()=>this.mapView,"pointer-move",o=>{const c={include:[this.layerView.layer]};this.hoverHitTest(o,c)})}animatePointPopEffect(e){e.symbolAnimation.start({onStep:this.onAnimationStep,onFinish:()=>{const t=this.mapView.toScreen(e.geometry);this.confetti({particleCount:140,spread:360,scalar:1.4,gravity:.8,startVelocity:20,origin:{x:t.x/this.mapView.width,y:t.y/this.mapView.height}}),e.symbol=g(1)}})}destroy(){this.clickHandler.remove(),this.hoverHandler.remove()}}function q(n){return[{type:"CIMVectorMarker",enable:n>0&&n<1,offsetX:17.5*(n-1),offsetY:-3,size:35,anchorPoint:{x:0,y:0},frame:{xmin:-100,ymin:0,xmax:100,ymax:100},markerGraphics:[{type:"CIMMarkerGraphic",primitiveName:"",textString:"",geometry:{rings:[[[-50*n,-20],[-50*n,-5],[50*n,-5],[50*n,-20]]]},symbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:[113,200,55,255]}]}}]},{type:"CIMVectorMarker",enable:n>0&&n<1,offsetX:17.5*n,offsetY:-3,size:35,anchorPoint:{x:0,y:0},frame:{xmin:-100,ymin:0,xmax:100,ymax:100},markerGraphics:[{type:"CIMMarkerGraphic",primitiveName:"",textString:"",geometry:{rings:[[[-50*(1-n),-20],[-50*(1-n),-5],[50*(1-n),-5],[50*(1-n),-20]]]},symbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:[255,0,0,255]}]}}]}]}function g(n){return new I({data:{type:"CIMSymbolReference",symbol:{type:"CIMPointSymbol",symbolLayers:[...q(n),{type:"CIMPictureMarker",enable:!0,anchorPoint:{x:0,y:0},offsetX:0,offsetY:0,size:40,scaleX:1,tintColor:[255,255,255,255],url:n<1?X:Y}]}}})}class B{constructor({symbolAnimationManager:e,mapView:t,layerView:r,to:a,easingConfig:i}){s(this,"mapView");s(this,"layerView");s(this,"to");s(this,"easingConfig");s(this,"symbolAnimationManager");s(this,"hoverHandler");s(this,"hitTest",A(async(e,t)=>{const{results:r}=await this.mapView.hitTest(e,t),a=r.filter(i=>i.type="graphic");if(a.length){const i=a[0].graphic;this.mapView.container.style.cursor="pointer",i.symbol=await b(i),this.activeGraphic=i}else this.mapView.container.style.cursor="default",this.activeGraphic=null},70));s(this,"_activeGraphic",null);this.mapView=t,this.layerView=r,this.to=a,this.easingConfig=i,this.symbolAnimationManager=e,this.hoverHandler=u(()=>this.mapView,"pointer-move",o=>{const c={include:[this.layerView.layer]};this.hitTest(o,c)})}set activeGraphic(e){if(e&&this.symbolAnimationManager.hasAnimatedGraphic({graphic:e}))return;if(this._activeGraphic===null){if(e===null)return}else{const r=this.symbolAnimationManager.getAnimatedGraphic({graphic:this._activeGraphic});r&&this.cancelAnimation(r)}if(this._activeGraphic=e,this._activeGraphic===null)return;const t=this.symbolAnimationManager.makeAnimatableSymbol({graphic:this._activeGraphic,easingConfig:this.easingConfig});this.animatePointPopEffect(t)}animatePointPopEffect(e){e.symbolAnimation.start({to:this.to})}cancelAnimation(e){e.symbolAnimation.start({to:{scale:1,rotate:0},onFinish:()=>{this.symbolAnimationManager.removeAnimatedGraphic({graphic:e})}})}destroy(){this.hoverHandler.remove()}}class K{constructor({symbolAnimationManager:e,graphics:t}){s(this,"symbolAnimationManager");s(this,"intervalId");this.symbolAnimationManager=e,this.intervalId=this.animateRandomItem(t)}animateRandomItem(e){return window.setInterval(()=>{const t=Math.floor(Math.random()*e.length),a=e[t].clone();a.symbol=new P({color:[255,255,255,0],size:30,outline:{color:[255,0,0,.8],style:"solid",width:4}});const i=Date.now().toString(),o=this.symbolAnimationManager.makeAnimatableSymbol({animationId:i,graphic:a,easingConfig:{type:"easing",options:{easingFunction:"easeInOutCubic",duration:1500}},isOverlay:!0});o.symbolAnimation.start({to:{scale:1.7},onFinish:()=>{this.symbolAnimationManager.removeAnimatedGraphic({graphic:o})}})},2e3)}destroy(){window.clearInterval(this.intervalId)}}const V=new G({basemap:new x({portalItem:{id:"a8c045aa74d643cc9e2fa2702cc4cb45"}})}),h=new T({container:"viewDiv",map:V,constraints:{minZoom:10},center:[-2.362,51.383],zoom:15}),W=document.getElementById("titleDiv");h.ui.add(W,"top-right");const w=document.getElementById("modeSelect");w==null||w.addEventListener("change",n=>{Z(n)});const l=new L({portalItem:{id:"ae3681977a0749e98867e42728196b3a"},popupEnabled:!1,outFields:["*"]});V.add(l);let p,m,d,f,k;h.whenLayerView(l).then(async n=>{k=await l.queryFeatures({where:"1=1",returnGeometry:!0}),d=n,m=new E({mapView:h,layerView:n}),f=l.renderer.clone(),l.renderer=new v({symbol:g(0)}),p=new M({symbolAnimationManager:m,mapView:h,layerView:d})});function Z(n){if(n.target){const e=n.target,t=e.options[e.selectedIndex].value;switch(p.destroy(),m.removeAllAnimatedGraphics(),t){case"radar-ping":{l.renderer=f,p=new K({symbolAnimationManager:m,graphics:k.features});break}case"hover-pop-effect":{l.renderer=f,p=new B({symbolAnimationManager:m,mapView:h,layerView:d,to:{scale:1.5,rotate:10},easingConfig:{type:"spring",options:F.molasses}});break}case"click-pop-effect":{l.renderer=f,p=new D({symbolAnimationManager:m,mapView:h,layerView:d,to:{scale:1.5,rotate:20},easingConfig:{type:"spring",options:{tension:280,friction:40,mass:10}}});break}case"custom-animation":{l.renderer=new v({symbol:g(0)}),p=new M({symbolAnimationManager:m,mapView:h,layerView:d});break}}}}
